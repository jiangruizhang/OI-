# NTT

$NTT$和$FTT$十分相似，在$FTT$中使用了单位复根$\omega$来取函数值，在$NTT$中则使用原根$g$来取函数值。在$NTT$中，所有的数都是模意义下的。

#### $g$​的一些性质

1. $g^1,g^2,\cdots,g^{p-1}$在模$p$意义下互不相同
2. 根据欧拉定理可知$g^{p-1} \equiv 1$

#### 用$g$来替换$\omega$实现$FFT$到$NTT$的转化

其实只要$g$能够在模意义下实现$\omega$的性质就行了。

假设$p=qn+1$​​，其中$n$​​是一个$2$​​的幂，我们钦定在对$f_n(x)$进行$NTT$​​时使用的单位原根是$g_n$，其计算方式为$g_n=g^{q}=g^{\frac{p-1}{n}}$

下面考虑$\omega$在$FFT$中使用到的性质：

1. $\omega_{2n}^{2i}=\omega_{n}^{i}$，$g_{2n}^{2i}=g^{\frac{p-1}{2n}·2i}=g^{\frac{p-1}{n}·i}=g_{n}^{i}$
2. $\omega_{n}^{\frac{n}{2}}=-1$​，$g_{n}^{\frac{n}{2}}=g^{\frac{p-1}{2}}= \sqrt {g^{p-1}}=\sqrt 1$，根据二次探索定理可知，在模意义下$\sqrt 1$只有两种取值，即$1$或$p-1$，根据原根的性质一排除取值为$1$的可能，那么$g_{n}^{\frac{n}{2}}=\sqrt 1=p-1=-1$
3. $\forall k \in Z,\omega_{n}^{kn}=1$，$\forall k \in Z,g_{n}^{kn}=(g_{n}^{n})^k=(g^{p-1})^k=1$​

#### 从$FFT$到$NTT$

我们只要把单位复根替换为单位原根即可，一切计算都在模意义下进行