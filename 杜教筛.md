# 杜教筛

杜教筛用于计算函数的前缀和。

若需要计算前缀和的函数为$f$，前缀和函数为$S$，那么有$S(n)=\sum_{i=1}^{n}f(i)$。现在通过构造一个合适的函数$g$，优化其计算过程。

对于任意和两个函数$f,g$，以下均成立：
$$
\sum_{i=1}^{n}\sum_{d|i}g(d)f(\frac{i}{d})=\sum_{i=1}^{n}g(i)\sum_{i=1}^{\lfloor \frac{n}{i} \rfloor} f(i)=\sum_{i=1}^{n}g(i)S(\lfloor \frac{n}{i} \rfloor) \\
g(1)S(n)=\sum_{i=1}^{n}(g*f)(i)-\sum_{i=2}^{n}g(i)S(\lfloor \frac{n}{i} \rfloor)
$$
可以发现等式右边减法部分，关于$S(\lfloor \frac{n}{i} \rfloor)$的部分是数论分块的形式，如果函数$g$能够快速的计算一段的和（前缀和），那么后半部分就可以用数论分块的形式解决。同时，前半部分在迪利克雷卷积之后得到的函数如果能快速计算前缀和，那么这个转移就可以快速计算了。

分析一下可以发现，由于$S(x)$中$x$的的取值全部都可以表示成$\lfloor \frac{n}{x'} \rfloor$的形式，所以只会有$\sqrt n$种取值。

并且在杜教筛之前可以预处理一部分前缀和，这样可以跑的更快。

### 提要

要构造一个函数$g$，满足如下条件：

1. 与求前缀和的函数$f$，迪利克雷卷积之后方便计算
2. 本身方便计算

